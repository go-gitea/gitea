{{template "org/settings/layout_head" (dict "ctxData" . "pageClass" "organization settings actions")}}
<div class="org-setting-content">
	<h4 class="ui top attached header">
		{{ctx.Locale.Tr "actions.actions"}} - {{ctx.Locale.Tr "settings.general"}}
	</h4>
	<div class="ui attached segment">
		<form class="ui form" action="{{.Link}}" method="post">
			{{.CsrfTokenHtml}}

			<!-- Cross-Repository Access -->
			<h5 class="ui header">
				{{ctx.Locale.Tr "actions.general.token_permissions.cross_repo"}}
			</h5>
			<p class="help">{{ctx.Locale.Tr "actions.general.token_permissions.cross_repo_desc"}}</p>

			<div class="grouped fields">
				<div class="field">
					<div class="ui radio checkbox">
						<input type="radio" name="cross_repo_mode" value="none" {{if not .AllowCrossRepoAccess}}checked{{end}} class="js-cross-repo-mode">
						<label>{{ctx.Locale.Tr "settings.disabled"}}</label>
					</div>
				</div>
				<div class="field">
					<div class="ui radio checkbox">
						<input type="radio" name="cross_repo_mode" value="all" {{if and .AllowCrossRepoAccess (not .HasSelectedRepos)}}checked{{end}} class="js-cross-repo-mode">
						<label>{{ctx.Locale.Tr "actions.general.token_permissions.cross_repo_all"}}</label>
					</div>
				</div>
				<div class="field">
					<div class="ui radio checkbox">
						<input type="radio" name="cross_repo_mode" value="selected" {{if and .AllowCrossRepoAccess .HasSelectedRepos}}checked{{end}} class="js-cross-repo-mode">
						<label>{{ctx.Locale.Tr "actions.general.token_permissions.cross_repo_selected"}}</label>
					</div>
				</div>
			</div>

			<!-- Allowed Repositories List -->
			<div id="allowed-repos-section" class="field">
				<h5 class="ui header">
					{{ctx.Locale.Tr "actions.general.token_permissions.allowed_repos"}}
				</h5>
				<div class="ui middle aligned divided list">
					{{range .AllowedRepos}}
						<div class="item">
							<div class="right floated content">
								<button class="ui red tiny button" formmethod="post" formaction="{{$.Link}}/allowed_repos/remove?repo_id={{.ID}}">{{ctx.Locale.Tr "remove"}}</button>
							</div>
							<div class="content">
								<a href="{{.Link}}">{{.Name}}</a>
							</div>
						</div>
					{{else}}
						<div class="item text empty">{{ctx.Locale.Tr "org.repos.none"}}</div>
					{{end}}
				</div>

				<h5 class="ui header">
					{{ctx.Locale.Tr "actions.general.token_permissions.add_repo"}}
				</h5>
				<div class="ui action input">
					<input name="repo_name" placeholder="{{ctx.Locale.Tr "search.search_repo"}}">
					<button class="ui green button" formmethod="post" formaction="{{$.Link}}/allowed_repos/add">{{ctx.Locale.Tr "add"}}</button>
				</div>
			</div>

			<div class="divider"></div>

			<!-- Default Permission Mode -->
			<h5 class="ui header">
				{{ctx.Locale.Tr "actions.general.token_permissions.mode"}}
			</h5>
			<div class="grouped fields">
				<div class="field">
					<div class="ui radio checkbox">
						<input type="radio" name="token_permission_mode" value="permissive" {{if eq .TokenPermissionMode .TokenPermissionModePermissive}}checked{{end}} class="js-permission-mode-radio">
						<label>{{ctx.Locale.Tr "actions.general.token_permissions.mode.permissive"}}</label>
					</div>
					<p class="help">{{ctx.Locale.Tr "actions.general.token_permissions.mode.permissive.desc"}}</p>
				</div>
				<div class="field">
					<div class="ui radio checkbox">
						<input type="radio" name="token_permission_mode" value="restricted" {{if eq .TokenPermissionMode .TokenPermissionModeRestricted}}checked{{end}} class="js-permission-mode-radio">
						<label>{{ctx.Locale.Tr "actions.general.token_permissions.mode.restricted"}}</label>
					</div>
					<p class="help">{{ctx.Locale.Tr "actions.general.token_permissions.mode.restricted.desc"}}</p>
				</div>
				<div class="field">
					<div class="ui radio checkbox">
						<input type="radio" name="token_permission_mode" value="custom" {{if eq .TokenPermissionMode .TokenPermissionModeCustom}}checked{{end}} class="js-permission-mode-radio">
						<label>{{ctx.Locale.Tr "actions.general.token_permissions.mode.custom"}}</label>
					</div>
					<p class="help">{{ctx.Locale.Tr "actions.general.token_permissions.mode.custom.desc"}}</p>
				</div>
			</div>

			<div class="divider"></div>

			<!-- Maximum Permissions Table -->
			<div id="max-permissions-section">
				<h5 class="ui header">
					{{ctx.Locale.Tr "actions.general.token_permissions.max_permissions"}}
				</h5>
				<p class="help">{{ctx.Locale.Tr "actions.general.token_permissions.max_permissions.desc"}}</p>
			</div>

			<table class="ui celled table js-permissions-table">
				<thead>
					<tr>
						<th style="width: 40%">{{ctx.Locale.Tr "units.unit"}}</th>
						<th style="width: 20%; text-align: center">{{ctx.Locale.Tr "actions.general.token_permissions.access_none"}}</th>
						<th style="width: 20%; text-align: center">{{ctx.Locale.Tr "actions.general.token_permissions.access_read"}}</th>
						<th style="width: 20%; text-align: center">{{ctx.Locale.Tr "actions.general.token_permissions.access_write"}}</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>
							<strong>{{ctx.Locale.Tr "actions.general.token_permissions.contents"}}</strong>
							<p class="text small grey">{{ctx.Locale.Tr "actions.general.token_permissions.contents.description"}}</p>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_contents" value="none" {{if not ($.MaxTokenPermissions.HasRead "contents")}}checked{{end}}>
								<label></label>
							</div>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_contents" value="read" {{if and ($.MaxTokenPermissions.HasRead "contents") (not ($.MaxTokenPermissions.HasWrite "contents"))}}checked{{end}}>
								<label></label>
							</div>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_contents" value="write" {{if $.MaxTokenPermissions.HasWrite "contents"}}checked{{end}}>
								<label></label>
							</div>
						</td>
					</tr>
					<tr>
						<td>
							<strong>{{ctx.Locale.Tr "actions.general.token_permissions.issues"}}</strong>
							<p class="text small grey">{{ctx.Locale.Tr "actions.general.token_permissions.issues.description"}}</p>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_issues" value="none" {{if not ($.MaxTokenPermissions.HasRead "issues")}}checked{{end}}>
								<label></label>
							</div>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_issues" value="read" {{if and ($.MaxTokenPermissions.HasRead "issues") (not ($.MaxTokenPermissions.HasWrite "issues"))}}checked{{end}}>
								<label></label>
							</div>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_issues" value="write" {{if $.MaxTokenPermissions.HasWrite "issues"}}checked{{end}}>
								<label></label>
							</div>
						</td>
					</tr>
					<tr>
						<td>
							<strong>{{ctx.Locale.Tr "actions.general.token_permissions.pull_requests"}}</strong>
							<p class="text small grey">{{ctx.Locale.Tr "actions.general.token_permissions.pull_requests.description"}}</p>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_pull_requests" value="none" {{if not ($.MaxTokenPermissions.HasRead "pull_requests")}}checked{{end}}>
								<label></label>
							</div>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_pull_requests" value="read" {{if and ($.MaxTokenPermissions.HasRead "pull_requests") (not ($.MaxTokenPermissions.HasWrite "pull_requests"))}}checked{{end}}>
								<label></label>
							</div>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_pull_requests" value="write" {{if $.MaxTokenPermissions.HasWrite "pull_requests"}}checked{{end}}>
								<label></label>
							</div>
						</td>
					</tr>
					<tr>
						<td>
							<strong>{{ctx.Locale.Tr "actions.general.token_permissions.wiki"}}</strong>
							<p class="text small grey">{{ctx.Locale.Tr "actions.general.token_permissions.wiki.description"}}</p>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_wiki" value="none" {{if not ($.MaxTokenPermissions.HasRead "wiki")}}checked{{end}}>
								<label></label>
							</div>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_wiki" value="read" {{if and ($.MaxTokenPermissions.HasRead "wiki") (not ($.MaxTokenPermissions.HasWrite "wiki"))}}checked{{end}}>
								<label></label>
							</div>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_wiki" value="write" {{if $.MaxTokenPermissions.HasWrite "wiki"}}checked{{end}}>
								<label></label>
							</div>
						</td>
					</tr>
					<tr>
						<td>
							<strong>{{ctx.Locale.Tr "actions.general.token_permissions.packages"}}</strong>
							<p class="text small grey">{{ctx.Locale.Tr "actions.general.token_permissions.packages.description"}}</p>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_packages" value="none" {{if not ($.MaxTokenPermissions.HasRead "packages")}}checked{{end}}>
								<label></label>
							</div>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_packages" value="read" {{if and ($.MaxTokenPermissions.HasRead "packages") (not ($.MaxTokenPermissions.HasWrite "packages"))}}checked{{end}}>
								<label></label>
							</div>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_packages" value="write" {{if $.MaxTokenPermissions.HasWrite "packages"}}checked{{end}}>
								<label></label>
							</div>
						</td>
					</tr>
					<tr>
						<td>
							<strong>{{ctx.Locale.Tr "actions.general.token_permissions.actions_scope"}}</strong>
							<p class="text small grey">{{ctx.Locale.Tr "actions.general.token_permissions.actions_scope.description"}}</p>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_actions" value="none" {{if not ($.MaxTokenPermissions.HasRead "actions")}}checked{{end}}>
								<label></label>
							</div>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_actions" value="read" {{if and ($.MaxTokenPermissions.HasRead "actions") (not ($.MaxTokenPermissions.HasWrite "actions"))}}checked{{end}}>
								<label></label>
							</div>
						</td>
						<td style="text-align: center">
							<div class="ui radio checkbox">
								<input type="radio" name="max_actions" value="write" {{if $.MaxTokenPermissions.HasWrite "actions"}}checked{{end}}>
								<label></label>
							</div>
						</td>
					</tr>
				</tbody>
			</table>

			<div class="divider"></div>

			<div class="field">
				<button class="ui primary button">{{ctx.Locale.Tr "repo.settings.update_settings"}}</button>
			</div>
		</form>
	</div>
</div>
{{template "org/settings/layout_footer" .}}
