{{template "base/head" .}}
<div role="main" aria-label="{{.Title}}" class="page-content organization teams">
	{{template "org/header" .}}
	<div class="ui container">
		{{template "base/alert" .}}

		<div class="list-header">
			<div class="small-menu-items ui compact tiny menu list-header-search">
				<a class="{{if not .Keyword}}active {{end}}item" href="{{$.OrgLink}}/teams">{{ctx.Locale.Tr "all"}}</a>
			</div>
			<form class="list-header-search ui small fluid action input">
				<input type="text" name="q" value="{{.Keyword}}" placeholder="{{ctx.Locale.Tr "search.team_kind"}}">
				{{template "shared/search/button"}}
			</form>
			{{if .IsOrganizationOwner}}
				<a class="ui primary small button" href="{{.OrgLink}}/teams/new">{{svg "octicon-plus"}} {{ctx.Locale.Tr "org.create_new_team"}}</a>
			{{end}}
		</div>
		<div class="divider"></div>

		<div class="flex-list">
			{{range .Teams}}
				<div class="flex-item tw-items-start">
					<div class="flex-item-main">
						<div class="flex-item-header">
							<div class="flex-item-title">
								{{svg "octicon-people" 16}}
								<a class="text black" href="{{$.OrgLink}}/teams/{{.LowerName | PathEscape}}"><strong>{{.Name}}</strong></a>
							</div>
							<div class="flex-item-trailing">
								<a class="ui primary tiny button" href="{{$.OrgLink}}/teams/{{.LowerName | PathEscape}}">{{ctx.Locale.Tr "view"}}</a>
								{{if .IsMember ctx $.SignedUser.ID}}
									<form>
										<button class="ui red tiny button delete-button" data-modal-id="leave-team"
											data-url="{{$.OrgLink}}/teams/{{.LowerName | PathEscape}}/action/leave" data-datauid="{{$.SignedUser.ID}}"
											data-name="{{.Name}}">{{ctx.Locale.Tr "org.teams.leave"}}</button>
									</form>
								{{else if $.IsOrganizationOwner}}
									<form method="post" action="{{$.OrgLink}}/teams/{{.LowerName | PathEscape}}/action/join">
										<button type="submit" class="ui primary tiny button" name="uid" value="{{$.SignedUser.ID}}">{{ctx.Locale.Tr "org.teams.join"}}</button>
									</form>
								{{end}}
							</div>
						</div>
						{{if .Description}}
							<div class="flex-item-body">
								{{.Description}}
							</div>
						{{end}}
						<div class="flex-item-body">
							<a class="muted" href="{{$.OrgLink}}/teams/{{.LowerName | PathEscape}}">{{.NumMembers}} {{ctx.Locale.Tr "org.lower_members"}}</a>
							Â·
							<a class="muted" href="{{$.OrgLink}}/teams/{{.LowerName | PathEscape}}/repositories">{{.NumRepos}} {{ctx.Locale.Tr "org.lower_repositories"}}</a>
						</div>
						<div class="flex-item-body">
							{{range .Members}}
								{{template "shared/user/avatarlink" dict "user" . "Size" 28}}
							{{end}}
						</div>
					</div>
				</div>
			{{else}}
				<div class="flex-item">
					<span class="text grey">{{ctx.Locale.Tr "org.teams.no_teams"}}</span>
				</div>
			{{end}}
		</div>

		{{template "base/paginate" .}}
	</div>
</div>
<div class="ui g-modal-confirm delete modal" id="leave-team">
	<div class="header">
		{{ctx.Locale.Tr "org.teams.leave"}}
	</div>
	<div class="content">
		<p>{{ctx.Locale.Tr "org.teams.leave.detail" (HTMLFormat `<span class="%s"></span>` "name")}}</p>
	</div>
	{{template "base/modal_actions_confirm" .}}
</div>
{{template "base/footer" .}}
