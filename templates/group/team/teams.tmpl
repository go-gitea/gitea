{{template "base/head" .}}
<div role="main" aria-label="{{.Title}}" class="page-content repo-group teams">
	{{template "group/header" .}}
	<div class="ui container">
		{{template "base/alert" .}}

		<div class="ui mobile reversed stackable grid">
			<div class="eleven wide column">
				<div class="ui two column stackable grid">
					{{if or .IsGroupAdmin .IsGroupOwner}}

						<div class="one column row">
							<div class="column">
								<form class="ui form ignore-dirty tw-flex tw-flex-wrap tw-gap-2" action="{{$.OrgGroupLink}}/teams/add"
											method="post">
									{{.CsrfTokenHtml}}
									<input type="hidden" name="uid" value="{{.SignedUser.ID}}">
									<div id="search-team-box" data-search-url="{{$.OrgLink}}/-/search_team_candidates"
											 class="ui search tw-mr-2 tw-flex-grow">
										<div class="ui input fluid">
											<input class="prompt" name="tname" placeholder="{{ctx.Locale.Tr "search.team_kind"}}"
														 autocomplete="off" required>
										</div>
									</div>
									<button class="ui primary button">{{ctx.Locale.Tr "group.teams.add"}}</button>
								</form>
							</div>
						</div>
					{{end}}
					{{range .Teams}}
						<div class="column">
							<div class="ui top attached header">
								<a class="text black"
									 href="{{$.OrgLink}}/teams/{{.LowerName | PathEscape}}"><strong>{{.Name}}</strong></a>
								<div class="ui right">
									<a class="ui primary tiny button"
										 href="{{$.OrgLink}}/teams/{{.LowerName | PathEscape}}">{{ctx.Locale.Tr "view"}}</a>

									{{if .IsMember ctx $.SignedUser.ID}}
										<form>
											<button class="ui red tiny button delete-button" data-modal-id="leave-team"
															data-url="{{$.OrgLink}}/teams/{{.LowerName | PathEscape}}/action/leave"
															data-datauid="{{$.SignedUser.ID}}"
															data-name="{{.Name}}">{{ctx.Locale.Tr "org.teams.leave"}}</button>
										</form>
									{{else if $.IsOrganizationOwner}}
										<form method="post" action="{{$.OrgLink}}/teams/{{.LowerName | PathEscape}}/action/join">
											{{$.CsrfTokenHtml}}
											<button type="submit" class="ui primary tiny button" name="uid"
															value="{{$.SignedUser.ID}}">{{ctx.Locale.Tr "org.teams.join"}}</button>
										</form>
									{{end}}

									{{if and (or $.IsGroupAdmin $.IsGroupOwner) (not .IsOwnerTeam)}}
										<form>
											<button class="ui red tiny button delete-button" data-modal-id="remove-team"
															data-url="{{$.OrgGroupLink}}/teams/{{.LowerName | PathEscape}}/remove"
															data-datauid="{{$.SignedUser.ID}}"
															data-name="{{.Name}}">{{ctx.Locale.Tr "group.teams.remove"}}</button>
										</form>
									{{end}}
								</div>
							</div>
							<div class="ui attached segment members">
								{{range .Members}}
									{{template "shared/user/avatarlink" dict "user" .}}
								{{end}}
							</div>
							<div class="ui bottom attached header">
								<p class="team-meta"><a class="muted"
																				href="{{$.OrgLink}}/teams/{{.LowerName | PathEscape}}">{{.NumMembers}} {{ctx.Locale.Tr "org.lower_members"}}</a>
									Â· <a class="muted"
											 href="{{$.OrgLink}}/teams/{{.LowerName | PathEscape}}/repositories">{{.NumRepos}} {{ctx.Locale.Tr "org.lower_repositories"}}</a>
								</p>
							</div>
						</div>
					{{end}}
				</div>
			</div>
			<div class="five wide column">
				{{template "group/sidebar/menu" .}}
			</div>
		</div>
	</div>
</div>
<div class="ui g-modal-confirm delete modal" id="leave-team">
	<div class="header">
		{{ctx.Locale.Tr "org.teams.leave"}}
	</div>
	<div class="content">
		<p>{{ctx.Locale.Tr "org.teams.leave.detail" (`<span class="name"></span>`)}}</p>
	</div>
	{{template "base/modal_actions_confirm" .}}
</div>
<div class="ui g-modal-confirm delete modal" id="remove-team">
	<div class="header">
		{{ctx.Locale.Tr "group.teams.remove"}}
	</div>
	<div class="content">
		<p>{{ctx.Locale.Tr "group.teams.remove.detail" (`<span class="name"></span>`)}}</p>
	</div>
	{{template "base/modal_actions_confirm" .}}
</div>
{{template "base/footer" .}}
